imports:
    - { resource: "../BaseConfig/config.yml" }

workflow:
    workflows:
        order_simple:
            marking_store:
                type: property_accessor
            supports:
                - AppBundle\Entity\Order
            places:
                - new
                - waiting_for_transportation
                - waiting_for_docs
                - at_warehouse
                - docs_ready
                - closed
            transitions:
                process:
                    from:
                        - new
                    to:
                        - waiting_for_transportation
                        - waiting_for_docs
                transportation_to_warehouse:
                    from:
                        - waiting_for_transportation
                    to:
                        - at_warehouse
                docs_processing:
                    from:
                        - waiting_for_docs
                    to:
                        - docs_ready
                deliver:
                    from:
                        - at_warehouse
                        - docs_ready
                    to:
                        - done

workflow_extensions:
    workflows:
        order_simple:
            guard:
                # prevent all transitions triggered by not fully authorized users
                expression: 'not container.get("access_checker").isGranted("ROLE_USER")'
                transitions:
                    # prevent delivering triggered by non-manager
                    deliver: 'not container.get("access_checker").isGranted("ROLE_MANAGER")'





